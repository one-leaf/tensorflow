1. 玻尔兹曼机

    玻尔兹曼机是用来学习二值向量上的任意概率分布。

    在 $d$ 维二值随机向量 $x\in \{0,1\}^d$ 上定义玻尔兹曼机：

    利用能量函数来定义联合概率分布：

    $$P(x)=\frac {exp(-E(x))}{Z}$$ 

    其中，E(x)是能量函数，Z是保持P(x)=1的配分函数。在玻尔兹曼机中的E(x)具体为：

    $$E(x)=-x^TWx-b^Tx$$

    W是权重矩阵，b为偏置。

    将x分解为两个单元 v 和 隐藏层h，则能量函数如下：

    $$E(v,h)=-v^TRv-v^TWh-h^TSh-b^Tv-c^Th$$

    其学习采用最大似然，所以具有配分函数难处理的问题。

1. 受限玻尔兹曼机

    受限玻尔兹曼机(RBM)由两层构成，包含一层可观察变量和单层潜变量的无向概率图模型。

    其联合概率分布如下：

    $$P(x,h)=\frac {exp(-E(x,h))}{Z}$$

    能量函数E定义如下：

    $$E(x,h)=-b^Tx-c^Th-x^TWh$$

    Z为配分函数的归一化函数：

    $$Z=\sum_x\sum_h exp(-E(x,h))$$

    作为无监督学习的特征提取，先随机h的权重w,加上激活函数计算x输入出正向结果，然后利用求输出和输入的散度做反向传播。

    1. 条件分布

        从联合分布导出条件分布：

        $$P(h|x)=\frac{P(h,x)}{P(x)}$$

        $$=\frac {1}{P(x)}\frac {1}{Z}exp(b^Tx+c^Th+x^TWh)$$

        $$=\frac {1}{Z'}exp(c^Th+x^TWh)$$

        $$=\frac {1}{Z'}exp(\sum_{j=1}^{n_h}c^T_jh_j+\sum_{n_h}^{j=1}x^TW_{:,j}h_j)$$

        $$=\frac {1}{Z'}\prod_{j=1}^{n_h}exp(c^T_jh_j+x^TW_{:,j}h_j)$$

        上式中，我们是相对 $x$ 计算 $P(h|x)$ 的条件概率，所以可以将 $x$ 看做常数。这样，其条件分布因子相乘的本质，可以将向量 $h$ 上的联合概率写成单独元素 $h_j$ 分布的乘积。这样原始问题转为了针对单个二值 $h_j$上分布进行归一化的简单问题。

        $$P(h_j=1|x)=\frac{\hat P(h_j=1|x)}{\hat P(h_j=0|x)+\hat P(h_j=1|x)}$$

        $$=\frac{exp(c_j+x^TW_{:,j})}{exp(0)+exp(c_j+x^TW_{:,j})}$$

        $$=\sigma(c_j+v^TW_{:,j})$$

        这样就可以将隐藏层的完全条件概率分布的因子形式为：

        $$P(h|x)=\prod_{j=1}^{n_h}\sigma((2h-1)\odot(c+W^Tx))_j$$

        $$P(x|h)=\prod_{i=1}^{n_x}\sigma((2x-1)\odot(b+Wh))_i$$

    1. 训练受限玻尔兹曼机

        由于RBM容易进行估计和微分以及采用，所以相对其他无向图模型而言，可以直接以闭解形式进行计算。

    







